<html>
<head>
    <LINK href='style.css' rel='stylesheet' type='text/css'>
    <script src='jquery-1.9.1.min.js' type="text/javascript"></script>
    <script src='datamaps-world.js' type="text/javascript"></script>
    <script src="reconnecting-websocket.min.js" type="text/javascript"></script>
    <script src="main.js" type="text/javascript" type="text/javascript"></script>
    <script>
        var RC_LOG_SIZE = 20;
        var WS_URL = 'ws://localhost:9000';  <!-- TODO -->

        /*  ================================================================ */
        $(document).ready(function() {
            world_map = $("#map")
                .datamap({scope: 'world',
                          bubbles:[],
                          geography_config: {
                          highlightOnHover: false,
                          popupOnHover: false
                         },
                        bubble_config: {
                            borderWidth: 0,
                            borderColor: '#000',
                            popupOnHover: true,
                            popupTemplate: _.template('<div class="hoverinfo"><%= data.page_title %></div>'),
                            fillOpacity: 0.75,
                            animate: true,
                            highlightOnHover: true,
                            highlightBorderColor: '#667FAF',
                            highlightFillColor: '#667FAF',
                            highlightBorderWidth: 1,
                            highlightFillOpacity: 0.85
                        },
                        fills: {
                            defaultFill: '#ccc',
                            'add': '#306596',
                            'subtract': '#cc4731'
                        }
                 });
            world_map.addBubbles = addBubbles;
            return;
        });

        enWikipediaSocket.init();
    </script>
</head>
<body>
    <h1>English Wikipedia Recent Changes Map</h1>
    <div id="wrapper">
        <div id='map'></div>
    </div>
    <div class='bg'>
        <div class='rc-list'>
        <h3>Recent changes
        </h3>
            <ul id='rc-list'>
            </ul>
        <div class='note'><p id='edit_counter'></p><p>For more, see Wikipedia's <a href="http://en.wikipedia.org/wiki/Special:RecentChanges">RecentChanges</a>.</p></div>
        </div>
    </div>
    <div class='foot'>
    <h3>What is this map?</h3>
    <p>When an <a href='http://en.wikipedia.org/wiki/Wikipedia:User_access_levels#Unregistered_users'>unregistered user</a> edits Wikipedia, he or she is identified by his or her IP address. These IP addresses are translated to geographic location using the <a href='http://freegeoip.net/'>freegeoip.net geolocation API</a>. Built using <a href='http://d3js.org'>d3</a>, <a href='http://datamaps.github.io/'>DataMaps</a>, and the <a href='http://meta.wikimedia.org/wiki/Research:Data#IRC_Feeds'>Wikimedia RecentChanges IRC feed</a>. Source <a href='https://github.com/slaporte/recentchanges_map'>available on github</a>.</p>
    <p>Built by Stephen LaPorte and Mahmoud Hashemi.</p>
    </div>
</body>
</html>
